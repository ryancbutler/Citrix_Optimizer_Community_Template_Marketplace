<?xml version="1.0" encoding="utf-8"?>
<root xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
  <metadata>
    <schemaversion>2.0</schemaversion>
    <version>1.0</version>
    <id>Windows_Server_2016_build_1607_dennisspan.com</id>
    <displayname>Windows Server 2016 1607 (Dennisspan.com)</displayname>
    <description>OS optimizations for Windows Server 2016 build 1607 (Dennisspan.com)</description>
    <category>OS Optimizations</category>
    <author>Dennis Span</author>
    <lastupdatedate>3/15/2019</lastupdatedate>
  </metadata>
  <group>
    <id>DisableServices</id>
    <displayname>Disable Services</displayname>
    <description>Disable services that are not required for VDI\RDS virtual machines</description>
    <entry>
      <name>AllJoyn Router Service</name>
      <description>Routes AllJoyn messages for the local AllJoyn clients.</description>
      <execute>1</execute>
      <action>
        <plugin>Services</plugin>
        <params>
          <name>AJRouter</name>
          <value>Disabled</value>
        </params>
      </action>
    </entry>
    <entry>
      <name>Application Layer Gateway Service</name>
      <description>Provides support for 3rd party protocol plug-ins for Internet Connection Sharing.</description>
      <execute>1</execute>
      <action>
        <plugin>Services</plugin>
        <params>
          <name>ALG</name>
          <value>Disabled</value>
        </params>
      </action>
    </entry>
    <entry>
      <name>Bluetooth Support Service</name>
      <description>The Bluetooth service supports discovery and association of remote Bluetooth devices.</description>
      <execute>1</execute>
      <action>
        <plugin>Services</plugin>
        <params>
          <name>bthserv</name>
          <value>Disabled</value>
        </params>
      </action>
    </entry>
    <entry>
      <name>Computer Browser</name>
      <description>Maintains an updated list of computers on the network and supplies this list to computers designated as browsers.</description>
      <execute>1</execute>
      <action>
        <plugin>Services</plugin>
        <params>
          <name>Browser</name>
          <value>Disabled</value>
        </params>
      </action>
    </entry>
    <entry>
      <name>Connected User Experiences and Telemetry</name>
      <description>The Connected User Experiences and Telemetry service enables features that support in-application and connected user experiences. Additionally, this service manages the event driven collection and transmission of diagnostic and usage information (used to improve the experience and quality of the Windows Platform) when the diagnostics and usage privacy option settings are enabled under Feedback and Diagnostics.</description>
      <execute>1</execute>
      <action>
        <plugin>Services</plugin>
        <params>
          <name>DiagTrack</name>
          <value>Disabled</value>
        </params>
      </action>
    </entry>
    <entry>
      <name>Diagnostic Policy Service</name>
      <description>The Diagnostic Policy Service enables problem detection, troubleshooting and resolution for Windows components.</description>
      <execute>1</execute>
      <action>
        <plugin>Services</plugin>
        <params>
          <name>DPS</name>
          <value>Disabled</value>
        </params>
      </action>
    </entry>
    <entry>
      <name>Diagnostic Service Host</name>
      <description>The Diagnostic Service Host is used by the Diagnostic Policy Service to host diagnostics that need to run in a Local Service context.</description>
      <execute>1</execute>
      <action>
        <plugin>Services</plugin>
        <params>
          <name>WdiServiceHost</name>
          <value>Disabled</value>
        </params>
      </action>
    </entry>
    <entry>
      <name>Diagnostic System Host</name>
      <description>The Diagnostic System Host is used by the Diagnostic Policy Service to host diagnostics that need to run in a Local System context.</description>
      <execute>1</execute>
      <action>
        <plugin>Services</plugin>
        <params>
          <name>WdiSystemHost</name>
          <value>Disabled</value>
        </params>
      </action>
    </entry>
    <entry>
      <name>Downloaded Maps Manager</name>
      <description>Windows service for application access to downloaded maps. This service is started on-demand by application accessing downloaded maps.</description>
      <execute>1</execute>
      <action>
        <plugin>Services</plugin>
        <params>
          <name>MapsBroker</name>
          <value>Disabled</value>
        </params>
      </action>
    </entry>
    <entry>
      <name>Encrypting File System (EFS)</name>
      <description>Provides the core file encryption technology used to store encrypted files on NTFS file system volumes.</description>
      <execute>1</execute>
      <action>
        <plugin>Services</plugin>
        <params>
          <name>EFS</name>
          <value>Disabled</value>
        </params>
      </action>
    </entry>
    <entry>
      <name>Function Discovery Provider Host</name>
      <description>The FDPHOST service hosts the Function Discovery (FD) network discovery providers. These FD providers supply network discovery services for the Simple Services Discovery Protocol (SSDP) and Web Services – Discovery (WS-D) protocol. Stopping or disabling the FDPHOST service will disable network discovery for these protocols when using FD. When this service is unavailable, network services using FD and relying on these discovery protocols will be unable to find network devices or resources.</description>
      <execute>1</execute>
      <action>
        <plugin>Services</plugin>
        <params>
          <name>fdPHost</name>
          <value>Disabled</value>
        </params>
      </action>
    </entry>
    <entry>
      <name>Function Discovery Resource Publication</name>
      <description>Publishes this computer and resources attached to this computer so they can be discovered over the network.</description>
      <execute>1</execute>
      <action>
        <plugin>Services</plugin>
        <params>
          <name>FDResPub</name>
          <value>Disabled</value>
        </params>
      </action>
    </entry>
    <entry>
      <name>Interactive Services Detection</name>
      <description>Enables user notification of user input for interactive services, which enables access to dialogs created by interactive services when they appear. If this service is stopped, notifications of new interactive service dialogs will no longer function and there might not be access to interactive service dialogs.</description>
      <execute>1</execute>
      <action>
        <plugin>Services</plugin>
        <params>
          <name>UI0Detect</name>
          <value>Disabled</value>
        </params>
      </action>
    </entry>
    <entry>
      <name>Internet Connection Sharing (ICS)</name>
      <description>Provides network address translation, addressing, name resolution and/or intrusion prevention services for a home or small office network.</description>
      <execute>1</execute>
      <action>
        <plugin>Services</plugin>
        <params>
          <name>SharedAccess</name>
          <value>Disabled</value>
        </params>
      </action>
    </entry>
    <entry>
      <name>Offline Files</name>
      <description>The Offline Files service performs maintenance activities on the Offline Files cache, responds to user logon and logoff events, implements the internals of the public API, and dispatches interesting events to those interested in Offline Files activities and changes in cache state.</description>
      <execute>1</execute>
      <action>
        <plugin>Services</plugin>
        <params>
          <name>CscService</name>
          <value>Disabled</value>
        </params>
      </action>
    </entry>
    <entry>
      <name>Optimize drives</name>
      <description>Helps the computer run more efficiently by optimizing files on storage drives.</description>
      <execute>1</execute>
      <action>
        <plugin>Services</plugin>
        <params>
          <name>defragsvc</name>
          <value>Disabled</value>
        </params>
      </action>
    </entry>
    <entry>
      <name>Secure Socket Tunneling Protocol Service</name>
      <description>Provides support for the Secure Socket Tunneling Protocol (SSTP) to connect to remote computers using VPN.</description>
      <execute>1</execute>
      <action>
        <plugin>Services</plugin>
        <params>
          <name>SstpSvc</name>
          <value>Disabled</value>
        </params>
      </action>
    </entry>
    <entry>
      <name>Sensor Monitoring Service</name>
      <description>Monitors various sensors in order to expose data and adapt to system and user state.</description>
      <execute>1</execute>
      <action>
        <plugin>Services</plugin>
        <params>
          <name>SensrSvc</name>
          <value>Disabled</value>
        </params>
      </action>
    </entry>
    <entry>
      <name>Shell Hardware Detection</name>
      <description>Provides notifications for AutoPlay hardware events.</description>
      <execute>1</execute>
      <action>
        <plugin>Services</plugin>
        <params>
          <name>ShellHWDetection</name>
          <value>Disabled</value>
        </params>
      </action>
    </entry>
    <entry>
      <name>SSDP Discovery</name>
      <description>Discovers networked devices and services that use the SSDP discovery protocol, such as UPnP devices. Also announces SSDP devices and services running on the local computer.</description>
      <execute>1</execute>
      <action>
        <plugin>Services</plugin>
        <params>
          <name>SSDPSRV</name>
          <value>Disabled</value>
        </params>
      </action>
    </entry>
    <entry>
      <name>UPnP Device Host</name>
      <description>Allows UPnP devices to be hosted on this computer.</description>
      <execute>1</execute>
      <action>
        <plugin>Services</plugin>
        <params>
          <name>upnphost</name>
          <value>Disabled</value>
        </params>
      </action>
    </entry>
    <entry>
      <name>Windows Mobile Hotspot Service</name>
      <description>Provides the ability to share a cellular data connection with another device.
Recommended by Microsoft to disable: https://docs.microsoft.com/en-us/windows-server/remote/remote-desktop-services/rds-vdi-recommendations</description>
      <execute>1</execute>
      <action>
        <plugin>Services</plugin>
        <params>
          <name>icssvc</name>
          <value>Disabled</value>
        </params>
      </action>
    </entry>
    <entry>
      <name>Windows Update</name>
      <description>Enables the detection, download, and installation of updates for Windows and other programs.</description>
      <execute>1</execute>
      <action>
        <plugin>Services</plugin>
        <params>
          <name>wuauserv</name>
          <value>Disabled</value>
        </params>
      </action>
    </entry>
    <entry>
      <name>Xbox Live Auth Manager</name>
      <description>Provides authentication and authorization services for interacting with Xbox Live.</description>
      <execute>1</execute>
      <action>
        <plugin>Services</plugin>
        <params>
          <name>XblAuthManager</name>
          <value>Disabled</value>
        </params>
      </action>
    </entry>
    <entry>
      <name>Xbox Live Game Save</name>
      <description>This service syncs save data for Xbox Live save enabled games.</description>
      <execute>1</execute>
      <action>
        <plugin>Services</plugin>
        <params>
          <name>XblGameSave</name>
          <value>Disabled</value>
        </params>
      </action>
    </entry>
  </group>
  <group>
    <id>DisableScheduledTasks</id>
    <displayname>Disable Scheduled Tasks</displayname>
    <description>Disable scheduled tasks that are not required for VDI\RDS virtual machines</description>
    <entry>
      <name>AnalyzeSystem</name>
      <description>This job analyzes the system looking for conditions that may cause high energy use.</description>
      <execute>1</execute>
      <action>
        <plugin>SchTasks</plugin>
        <params>
          <name>AnalyzeSystem</name>
          <path>\Microsoft\Windows\Power Efficiency Diagnostics</path>
          <value>Disabled</value>
        </params>
      </action>
    </entry>
    <entry>
      <name>BfeOnServiceStartTypeChange</name>
      <description>Adjusts the start type for firewall-triggered services when the start type of the Base Filtering Engine (BFE) is disabled.</description>
      <execute>1</execute>
      <action>
        <plugin>SchTasks</plugin>
        <params>
          <name>BfeOnServiceStartTypeChange</name>
          <path>\Microsoft\Windows\Windows Filtering Platform</path>
          <value>Disabled</value>
        </params>
      </action>
    </entry>
    <entry>
      <name>Consolidator</name>
      <description>Collects and sends usage data to Microsoft if opted-in to the Windows Customer Experience Improvement Program.</description>
      <execute>1</execute>
      <action>
        <plugin>SchTasks</plugin>
        <params>
          <name>Consolidator</name>
          <path>\Microsoft\Windows\Customer Experience Improvement Program</path>
          <value>Disabled</value>
        </params>
      </action>
    </entry>
    <entry>
      <name>CreateObjectTask</name>
      <description>Provides support for shell components that access system data.</description>
      <execute>1</execute>
      <action>
        <plugin>SchTasks</plugin>
        <params>
          <name>CreateObjectTask</name>
          <path>\Microsoft\Windows\CloudExperienceHost</path>
          <value>Disabled</value>
        </params>
      </action>
    </entry>
    <entry>
      <name>IndexerAutomaticMaintenance</name>
      <description>Keeps the search index up to date.</description>
      <execute>1</execute>
      <action>
        <plugin>SchTasks</plugin>
        <params>
          <name>IndexerAutomaticMaintenance</name>
          <path>\Microsoft\Windows\Shell</path>
          <value>Disabled</value>
        </params>
      </action>
    </entry>
    <entry>
      <name>KernelCeipTask</name>
      <description>Collects additional information about the system and sends to Microsoft if opted-in to Windows Customer Experience Improvement Program.</description>
      <execute>1</execute>
      <action>
        <plugin>SchTasks</plugin>
        <params>
          <name>KernelCeipTask</name>
          <path>\Microsoft\Windows\Customer Experience Improvement Program</path>
          <value>Disabled</value>
        </params>
      </action>
    </entry>
    <entry>
      <name>MapsToastTask</name>
      <description>This task shows various Map related toasts.</description>
      <execute>1</execute>
      <action>
        <plugin>SchTasks</plugin>
        <params>
          <name>MapsToastTask</name>
          <path>\Microsoft\Windows\Maps</path>
          <value>Disabled</value>
        </params>
      </action>
    </entry>
    <entry>
      <name>Microsoft Compatibility Appraiser</name>
      <description>Aggregates and uploads Application Telemetry information if opted-in to the Microsoft Customer Experience Improvement Program.</description>
      <execute>1</execute>
      <action>
        <plugin>SchTasks</plugin>
        <params>
          <name>Microsoft Compatibility Appraiser</name>
          <path>\Microsoft\Windows\Application Experience</path>
          <value>Disabled</value>
        </params>
      </action>
    </entry>
    <entry>
      <name>Microsoft-Windows-DiskDiagnosticDataCollector</name>
      <description>Reports general disk and system information to Microsoft for users participating in the Customer Experience Program.</description>
      <execute>1</execute>
      <action>
        <plugin>SchTasks</plugin>
        <params>
          <name>Microsoft-Windows-DiskDiagnosticDataCollector</name>
          <path>\Microsoft\Windows\DiskDiagnostic</path>
          <value>Disabled</value>
        </params>
      </action>
    </entry>
    <entry>
      <name>Microsoft-Windows-DiskDiagnosticResolver</name>
      <description>Warns users about faults reported by hard disks that support the Self Monitoring and Reporting Technology (S.M.A.R.T.) standard. This task is triggered automatically by the Diagnostic Policy Service when a S.M.A.R.T. fault is detected.</description>
      <execute>1</execute>
      <action>
        <plugin>SchTasks</plugin>
        <params>
          <name>Microsoft-Windows-DiskDiagnosticResolver</name>
          <path>\Microsoft\Windows\DiskDiagnostic</path>
          <value>Disabled</value>
        </params>
      </action>
    </entry>
    <entry>
      <name>MNO Metadata Parser</name>
      <description>Mobile broadband account experience metadata parser.</description>
      <execute>1</execute>
      <action>
        <plugin>SchTasks</plugin>
        <params>
          <name>MNO Metadata Parser</name>
          <path>\Microsoft\Windows\Mobile Broadband Accounts</path>
          <value>Disabled</value>
        </params>
      </action>
    </entry>
    <entry>
      <name>MobilityManager</name>
      <description>Provides support for the switching of mobility enabled VPN connections if their underlying interface goes down.</description>
      <execute>1</execute>
      <action>
        <plugin>SchTasks</plugin>
        <params>
          <name>MobilityManager</name>
          <path>\Microsoft\Windows\Ras</path>
          <value>Disabled</value>
        </params>
      </action>
    </entry>
    <entry>
      <name>Notifications</name>
      <description>Location notification.</description>
      <execute>1</execute>
      <action>
        <plugin>SchTasks</plugin>
        <params>
          <name>Notifications</name>
          <path>\Microsoft\Windows\Location</path>
          <value>Disabled</value>
        </params>
      </action>
    </entry>
    <entry>
      <name>ProactiveScan</name>
      <description>NTFS volume health scan.</description>
      <execute>1</execute>
      <action>
        <plugin>SchTasks</plugin>
        <params>
          <name>ProactiveScan</name>
          <path>\Microsoft\Windows\CHKDSK</path>
          <value>Disabled</value>
        </params>
      </action>
    </entry>
    <entry>
      <name>ProcessMemoryDiagnosticEvents</name>
      <description>Schedules a memory diagnostic in response to system events.</description>
      <execute>1</execute>
      <action>
        <plugin>SchTasks</plugin>
        <params>
          <name>ProcessMemoryDiagnosticEvents</name>
          <path>\Microsoft\Windows\MemoryDiagnostic</path>
          <value>Disabled</value>
        </params>
      </action>
    </entry>
    <entry>
      <name>ProgramDataUpdater</name>
      <description>Collects program telemetry information if opted-in to the Microsoft Customer Experience Improvement Program.</description>
      <execute>1</execute>
      <action>
        <plugin>SchTasks</plugin>
        <params>
          <name>ProgramDataUpdater</name>
          <path>\Microsoft\Windows\Application Experience</path>
          <value>Disabled</value>
        </params>
      </action>
    </entry>
    <entry>
      <name>Proxy</name>
      <description>Collects and uploads autochk SQM data if opted-in to the Microsoft Customer Experience Improvement Program.</description>
      <execute>1</execute>
      <action>
        <plugin>SchTasks</plugin>
        <params>
          <name>Proxy</name>
          <path>\Microsoft\Windows\Autochk</path>
          <value>Disabled</value>
        </params>
      </action>
    </entry>
    <entry>
      <name>QueueReporting</name>
      <description>Windows Error Reporting task to process queued reports.</description>
      <execute>1</execute>
      <action>
        <plugin>SchTasks</plugin>
        <params>
          <name>QueueReporting</name>
          <path>\Microsoft\Windows\Windows Error Reporting</path>
          <value>Disabled</value>
        </params>
      </action>
    </entry>
    <entry>
      <name>RegIdleBackup</name>
      <description>Registry idle backup task.</description>
      <execute>1</execute>
      <action>
        <plugin>SchTasks</plugin>
        <params>
          <name>RegIdleBackup</name>
          <path>\Microsoft\Windows\Registry</path>
          <value>Disabled</value>
        </params>
      </action>
    </entry>
    <entry>
      <name>ResolutionHost</name>
      <description>The Windows Diagnostic Infrastructure Resolution host enables interactive resolutions for system problems detected by the Diagnostic Policy Service. It is triggered when necessary by the Diagnostic Policy Service in the appropriate user session. If the Diagnostic Policy Service is not running, the task will not run.</description>
      <execute>1</execute>
      <action>
        <plugin>SchTasks</plugin>
        <params>
          <name>ResolutionHost</name>
          <path>\Microsoft\Windows\WDI</path>
          <value>Disabled</value>
        </params>
      </action>
    </entry>
    <entry>
      <name>RunFullMemoryDiagnostic</name>
      <description>Detects and mitigates problems in physical memory (RAM).</description>
      <execute>1</execute>
      <action>
        <plugin>SchTasks</plugin>
        <params>
          <name>RunFullMemoryDiagnostic</name>
          <path>\Microsoft\Windows\MemoryDiagnostic</path>
          <value>Disabled</value>
        </params>
      </action>
    </entry>
    <entry>
      <name>Scheduled</name>
      <description>Performs periodic maintenance of the computer system by fixing problems automatically or reporting them through the Action Center.</description>
      <execute>1</execute>
      <action>
        <plugin>SchTasks</plugin>
        <params>
          <name>Scheduled</name>
          <path>\Microsoft\Windows\Diagnosis</path>
          <value>Disabled</value>
        </params>
      </action>
    </entry>
    <entry>
      <name>ScheduledDefrag</name>
      <description>This task defragments the computers hard disk drives.</description>
      <execute>1</execute>
      <action>
        <plugin>SchTasks</plugin>
        <params>
          <name>ScheduledDefrag</name>
          <path>\Microsoft\Windows\Defrag</path>
          <value>Disabled</value>
        </params>
      </action>
    </entry>
    <entry>
      <name>ServerManager</name>
      <description>Task for launching Initial Configuration Tasks or Server Manager at logon.</description>
      <execute>1</execute>
      <action>
        <plugin>SchTasks</plugin>
        <params>
          <name>ServerManager</name>
          <path>\Microsoft\Windows\Server Manager</path>
          <value>Disabled</value>
        </params>
      </action>
    </entry>
    <entry>
      <name>SmartScreenSpecific</name>
      <description>Task that collects data for SmartScreen in Windows.</description>
      <execute>1</execute>
      <action>
        <plugin>SchTasks</plugin>
        <params>
          <name>SmartScreenSpecific</name>
          <path>\Microsoft\Windows\AppID</path>
          <value>Disabled</value>
        </params>
      </action>
    </entry>
    <entry>
      <name>StartComponentCleanup</name>
      <description>This job clean up components automatically when the system is not in use. This task is known to cause excessive CPU usage.</description>
      <execute>1</execute>
      <action>
        <plugin>SchTasks</plugin>
        <params>
          <name>StartComponentCleanup</name>
          <path>\Microsoft\Windows\Servicing</path>
          <value>Disabled</value>
        </params>
      </action>
    </entry>
    <entry>
      <name>StartupAppTask</name>
      <description>Scans startup entries and raises notification to the user if there are too many startup entries.</description>
      <execute>1</execute>
      <action>
        <plugin>SchTasks</plugin>
        <params>
          <name>StartupAppTask</name>
          <path>\Microsoft\Windows\Application Experience</path>
          <value>Disabled</value>
        </params>
      </action>
    </entry>
    <entry>
      <name>TPM-Maintenance</name>
      <description>This task supports the Trusted Platform Module (TPM) by performing background actions on behalf of the OS.</description>
      <execute>1</execute>
      <action>
        <plugin>SchTasks</plugin>
        <params>
          <name>TPM-Maintenance</name>
          <path>\Microsoft\Windows\TPM</path>
          <value>Disabled</value>
        </params>
      </action>
    </entry>
    <entry>
      <name>UninstallDeviceTask</name>
      <description>Uninstalls the PnP device associated with the specified Bluetooth service ID.</description>
      <execute>1</execute>
      <action>
        <plugin>SchTasks</plugin>
        <params>
          <name>UninstallDeviceTask</name>
          <path>\Microsoft\Windows\Bluetooth</path>
          <value>Disabled</value>
        </params>
      </action>
    </entry>
    <entry>
      <name>UPnPHostConfig</name>
      <description>Sets UPnPHost service to auto-start.</description>
      <execute>1</execute>
      <action>
        <plugin>SchTasks</plugin>
        <params>
          <name>UPnPHostConfig</name>
          <path>\Microsoft\Windows\UPnP</path>
          <value>Disabled</value>
        </params>
      </action>
    </entry>
    <entry>
      <name>UsbCeip</name>
      <description>Collects Universal Serial Bus related statistics and information about your machine and sends to the Windows Device Connectivity engineering group at Microsoft, if opted-in to Windows Customer Experience Improvement Program.</description>
      <execute>1</execute>
      <action>
        <plugin>SchTasks</plugin>
        <params>
          <name>UsbCeip</name>
          <path>\Microsoft\Windows\Customer Experience Improvement Program</path>
          <value>Disabled</value>
        </params>
      </action>
    </entry>
    <entry>
      <name>VerifyWinRE</name>
      <description>Validates the Windows Recovery Environment.</description>
      <execute>1</execute>
      <action>
        <plugin>SchTasks</plugin>
        <params>
          <name>VerifyWinRE</name>
          <path>\Microsoft\Windows\RecoveryEnvironment</path>
          <value>Disabled</value>
        </params>
      </action>
    </entry>
    <entry>
      <name>Windows Defender Cache Maintenance</name>
      <description>Periodic maintenance task.</description>
      <execute>1</execute>
      <action>
        <plugin>SchTasks</plugin>
        <params>
          <name>Windows Defender Cache Maintenance</name>
          <path>\Microsoft\Windows\Windows Defender</path>
          <value>Disabled</value>
        </params>
      </action>
    </entry>
    <entry>
      <name>Windows Defender Cleanup</name>
      <description>Periodic cleanup task.</description>
      <execute>1</execute>
      <action>
        <plugin>SchTasks</plugin>
        <params>
          <name>Windows Defender Cleanup</name>
          <path>\Microsoft\Windows\Windows Defender</path>
          <value>Disabled</value>
        </params>
      </action>
    </entry>
    <entry>
      <name>Windows Defender Scheduled Scan</name>
      <description>Periodic scan task.</description>
      <execute>1</execute>
      <action>
        <plugin>SchTasks</plugin>
        <params>
          <name>Windows Defender Scheduled Scan</name>
          <path>\Microsoft\Windows\Windows Defender</path>
          <value>Disabled</value>
        </params>
      </action>
    </entry>
    <entry>
      <name>Windows Defender Verification</name>
      <description>Periodic verification task.</description>
      <execute>1</execute>
      <action>
        <plugin>SchTasks</plugin>
        <params>
          <name>Windows Defender Verification</name>
          <path>\Microsoft\Windows\Windows Defender</path>
          <value>Disabled</value>
        </params>
      </action>
    </entry>
    <entry>
      <name>WinSAT</name>
      <description>Measures a system’s performance and capabilities.</description>
      <execute>1</execute>
      <action>
        <plugin>SchTasks</plugin>
        <params>
          <name>WinSAT</name>
          <path>\Microsoft\Windows\Maintenance</path>
          <value>Disabled</value>
        </params>
      </action>
    </entry>
    <entry>
      <name>XblGameSaveTask</name>
      <description>XblGameSave Standby Task</description>
      <execute>1</execute>
      <action>
        <plugin>SchTasks</plugin>
        <params>
          <name>XblGameSaveTask</name>
          <path>\Microsoft\XblGameSave</path>
          <value>Disabled</value>
        </params>
      </action>
    </entry>
    <entry>
      <name>XblGameSaveTaskLogon</name>
      <description>XblGameSave Logon Task</description>
      <execute>1</execute>
      <action>
        <plugin>SchTasks</plugin>
        <params>
          <name>XblGameSaveTaskLogon</name>
          <path>\Microsoft\XblGameSave</path>
          <value>Disabled</value>
        </params>
      </action>
    </entry>
  </group>
  <group>
    <id>Miscellaneous</id>
    <displayname>Miscellaneous</displayname>
    <description>Various optimizations and tweaks for VDI\RDS virtual machines</description>
    <entry>
      <name>Disable background auto-layout</name>
      <description>Disabling background auto-layout can help improve EWF performance.</description>
      <execute>1</execute>
      <action>
        <plugin>Registry</plugin>
        <params>
          <name>EnableAutoLayout</name>
          <path>HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\OptimalLayout</path>
          <value>0</value>
          <valuetype>DWORD</valuetype>
        </params>
      </action>
    </entry>
    <entry>
      <name>Disable background disk defragmentation</name>
      <description>Disabling background disk defragmentation can help improve EWF performance.</description>
      <execute>1</execute>
      <action>
        <plugin>Registry</plugin>
        <params>
          <name>Enable</name>
          <path>HKLM\SOFTWARE\Microsoft\Dfrg\BootOptimizeFunction</path>
          <value>N</value>
          <valuetype>String</valuetype>
        </params>
      </action>
    </entry>
    <entry>
      <name>Disable default system screensaver</name>
      <description>Disable default system screensaver.</description>
      <execute>1</execute>
      <action>
        <plugin>Registry</plugin>
        <params>
          <name>ScreenSaveActive</name>
          <path>HKU\.DEFAULT\Control Panel\Desktop</path>
          <value>0</value>
          <valuetype>DWORD</valuetype>
        </params>
      </action>
    </entry>
    <entry>
      <name>Disable memory dump creation</name>
      <description>Disable memory dump creation.</description>
      <execute>1</execute>
      <action>
        <plugin>Registry</plugin>
        <params>
          <name>CrashDumpEnabled</name>
          <path>HKLM\SYSTEM\CurrentControlSet\Control\CrashControl</path>
          <value>0</value>
          <valuetype>DWORD</valuetype>
        </params>
      </action>
    </entry>
    <entry>
      <name>Disable NTFS last access timestamps</name>
      <description>If you are using NTFS, you can increase the performance of EWF by disabling the last access date/time stamps.</description>
      <execute>1</execute>
      <action>
        <plugin>Registry</plugin>
        <params>
          <name>NtfsDisableLastAccessUpdate</name>
          <path>HKLM\SYSTEM\CurrentControlSet\Control\FileSystem</path>
          <value>1</value>
          <valuetype>DWORD</valuetype>
        </params>
      </action>
    </entry>
    <entry>
      <name>Hide hard error messages</name>
      <description>Disable system hard error messages.</description>
      <execute>1</execute>
      <action>
        <plugin>Registry</plugin>
        <params>
          <name>ErrorMode</name>
          <path>HKLM\System\CurrentControlSet\Control\Windows</path>
          <value>2</value>
          <valuetype>DWORD</valuetype>
        </params>
      </action>
    </entry>
    <entry>
      <name>Increase Disk I/O Timeout to 200 seconds</name>
      <description>Increase Disk I/O Timeout to 200 seconds.</description>
      <execute>1</execute>
      <action>
        <plugin>Registry</plugin>
        <params>
          <name>TimeOutValue</name>
          <path>HKLM\SYSTEM\CurrentControlSet\Services\Disk</path>
          <value>0x000000C8</value>
          <valuetype>DWORD</valuetype>
        </params>
      </action>
    </entry>
    <entry>
      <name>Disable Server Manager at logon</name>
      <description>Disable Server Manager at logon</description>
      <execute>1</execute>
      <action>
        <plugin>SchTasks</plugin>
        <params>
          <name>ServerManager</name>
          <path>\Microsoft\Windows\Server Manager</path>
          <value>Disabled</value>
        </params>
      </action>
    </entry>
  </group>
  <group>
    <id>DS_DisableActiveSetup</id>
    <displayname>DS: Disable Active Setup</displayname>
    <description>Disable all 32 and 64-bit Active Setup items to prevent them from running at first user logon.</description>
        <entry>
        <name>Disable Active Setup (32-bit)</name>
        <description>Disable all 32-bit Active Setup items to prevent them from running at first user logon. All Active Setup items are disable by renaming the registry key "HKLM\SOFTWARE\WOW6432Node\Microsoft\Active Setup\Installed Components". The key "Installed Components" will be renamed to "_DISABLED Installed Components_%Date%_%Time%". For example: "_DISABLED Installed Components_2018-10-31_02-42-10". Does not support rollback.</description>
        <execute>1</execute>
        <action>
          <plugin>PowerShell</plugin>
	   <executeparams>
            <value>  
               $DateTime = Get-Date -Format yyyy-MM-dd_hh-mm-ss
               $NewName = "_DISABLED Installed Components_$DateTime"
               $Path = "HKLM:\SOFTWARE\WOW6432Node\Microsoft\Active Setup\Installed Components"
               if ( Test-Path $Path ) {
                  try {
                     Rename-Item -path $Path -newname $NewName
                     $Global:CTXOE_Result = $True
                     $Global:CTXOE_Details = "All Active Setup items (32-bit) have been successfully disabled"
                  } catch {
                     $Global:CTXOE_Result = $False
                     $Global:CTXOE_Details = "An error occurred trying to disable all Active Setup items (32-bit)"
                  }
                } else {
                     $Global:CTXOE_Result = $True
                     $Global:CTXOE_Details = "All Active Setup items (32-bit) have already been disabled"
                }
            </value>
           </executeparams>
            <params>
             <value>
                $Path = "HKLM:\SOFTWARE\WOW6432Node\Microsoft\Active Setup\Installed Components"
		if ( Test-Path $Path ) { $Global:CTXOE_Result = $False } else { $Global:CTXOE_Result = $True }
                if ( Test-Path $Path ) { $Global:CTXOE_Details = "Active Setup is NOT optimized (= disabled)." } else { $Global:CTXOE_Details = "Active Setup is optimized (= disabled). Rollback is currently not supported." }
                Return
             </value>
            </params>
        </action>
      </entry>
      <entry>
        <name>Disable Active Setup (64-bit)</name>
        <description>Disable all 64-bit Active Setup items to prevent them from running at first user logon. All Active Setup items are disable by renaming the registry key "HKLM\SOFTWARE\Microsoft\Active Setup\Installed Components". The key "Installed Components" will be renamed to "_DISABLED Installed Components_%Date%_%Time%". For example: "_DISABLED Installed Components_2018-10-31_02-42-10". Does not support rollback.</description>
        <execute>1</execute>
        <action>
          <plugin>PowerShell</plugin>
	   <executeparams>
            <value>  
               $DateTime = Get-Date -Format yyyy-MM-dd_hh-mm-ss
               $NewName = "_DISABLED Installed Components_$DateTime"
               $Path = "HKLM:\SOFTWARE\Microsoft\Active Setup\Installed Components"
               if ( Test-Path $Path ) {
                  try {
                     Rename-Item -path $Path -newname $NewName
                     $Global:CTXOE_Result = $True
                     $Global:CTXOE_Details = "All Active Setup items (64-bit) have been successfully disabled"
                  } catch {
                     $Global:CTXOE_Result = $False
                     $Global:CTXOE_Details = "An error occurred trying to disable all Active Setup items (64-bit)"
                  }
                } else {
                     $Global:CTXOE_Result = $True
                     $Global:CTXOE_Details = "All Active Setup items (64-bit) have already been disabled"
                }
            </value>
           </executeparams>
            <params>
             <value>
                $Path = "HKLM:\SOFTWARE\Microsoft\Active Setup\Installed Components"
		if ( Test-Path $Path ) { $Global:CTXOE_Result = $False } else { $Global:CTXOE_Result = $True }
                if ( Test-Path $Path ) { $Global:CTXOE_Details = "Active Setup is NOT optimized (= disabled)." } else { $Global:CTXOE_Details = "Active Setup is optimized (= disabled). Rollback is currently not supported." }
                Return
             </value>
            </params>
        </action>
      </entry>
  </group>
  <group>
    <id>DS_DisableOtherServices</id>
    <displayname>DS: Disable Other Services</displayname>
    <description>Disable additional services besides the ones included in the Citrix Optimizer.</description>
    <entry>
      <name>App Readiness</name>
      <description>Gets apps ready for use the first time a user signs in to this PC and when adding new apps. This service causes black screen issues on Windows Server 2016. Disabling this service may cause an issue with Windows Update (if so, when updating the image, enable this service again).</description>
      <execute>1</execute>
      <action>
        <plugin>Services</plugin>
        <params>
          <name>AppReadiness</name>
          <value>Disabled</value>
        </params>
      </action>
    </entry>
    <entry>
      <name>Device Setup Manager</name>
      <description>Enables the detection, download and installation of device-related software. If this service is disabled, devices may be configured with outdated software, and may not work correctly.</description>
      <execute>1</execute>
      <action>
        <plugin>Services</plugin>
        <params>
          <name>DsmSvc</name>
          <value>Disabled</value>
        </params>
      </action>
    </entry>
    <entry>
      <name>dmwappushsvc</name>
      <description>WAP Push Message Routing Service.</description>
      <execute>1</execute>
      <action>
        <plugin>Services</plugin>
        <params>
          <name>dmwappushservice</name>
          <value>Disabled</value>
        </params>
      </action>
    </entry>
    <entry>
      <name>Network Connection Broker</name>
      <description>Brokers connections that allow Microsoft Store Apps to receive notifications from the internet.</description>
      <execute>1</execute>
      <action>
        <plugin>Services</plugin>
        <params>
          <name>NcbService</name>
          <value>Disabled</value>
        </params>
      </action>
    </entry>
    <entry>
      <name>Program Compatibility Assistant Service</name>
      <description>This service provides support for the Program Compatibility Assistant (PCA). PCA monitors programs installed and run by the user and detects known compatibility problems. If this service is stopped, PCA will not function properly.</description>
      <execute>1</execute>
      <action>
        <plugin>Services</plugin>
        <params>
          <name>PcaSvc</name>
          <value>Disabled</value>
        </params>
      </action>
    </entry>
    <entry>
      <name>Quality Windows Audio Video Experience</name>
      <description>Quality Windows Audio Video Experience (qWave) is a networking platform for Audio Video (AV) streaming applications on IP home networks. qWave enhances AV streaming performance and reliability by ensuring network quality-of-service (QoS) for AV applications. It provides mechanisms for admission control, run time monitoring and enforcement, application feedback, and traffic prioritization.</description>
      <execute>1</execute>
      <action>
        <plugin>Services</plugin>
        <params>
          <name>QWAVE</name>
          <value>Disabled</value>
        </params>
      </action>
    </entry>
    <entry>
      <name>Radio Management Service</name>
      <description>Radio Management and Airplane Mode Service.</description>
      <execute>1</execute>
      <action>
        <plugin>Services</plugin>
        <params>
          <name>RmSvc</name>
          <value>Disabled</value>
        </params>
      </action>
    </entry>
    <entry>
      <name>Sensor Data Service</name>
      <description>Delivers data from a variety of sensors.</description>
      <execute>1</execute>
      <action>
        <plugin>Services</plugin>
        <params>
          <name>SensorDataService</name>
          <value>Disabled</value>
        </params>
      </action>
    </entry>
    <entry>
      <name>Sensor Service</name>
      <description>A service for sensors that manages different sensors' functionality. Manages Simple Device Orientation (SDO) and History for sensors. Loads the SDO sensor that reports device orientation changes. If this service is stopped or disabled, the SDO sensor will not be loaded and so auto-rotation will not occur. History collection from Sensors will also be stopped.</description>
      <execute>1</execute>
      <action>
        <plugin>Services</plugin>
        <params>
          <name>SensorService</name>
          <value>Disabled</value>
        </params>
      </action>
    </entry>
    <entry>
      <name>WalletService</name>
      <description>Hosts objects used by clients of the wallet.</description>
      <execute>1</execute>
      <action>
        <plugin>Services</plugin>
        <params>
          <name>WalletService</name>
          <value>Disabled</value>
        </params>
      </action>
    </entry>
    <entry>
      <name>Windows Error Reporting Service</name>
      <description>Allows errors to be reported when programs stop working or responding and allows existing solutions to be delivered. Also allows logs to be generated for diagnostic and repair services. If this service is stopped, error reporting might not work correctly and results of diagnostic services and repairs might not be displayed.</description>
      <execute>1</execute>
      <action>
        <plugin>Services</plugin>
        <params>
          <name>WerSvc</name>
          <value>Disabled</value>
        </params>
      </action>
    </entry>
    <entry>
      <name>Windows Insider Service</name>
      <description>Provides infrastructure support for the Windows Insider Program. This service must remain enabled for the Windows Insider Program to work.</description>
      <execute>1</execute>
      <action>
        <plugin>Services</plugin>
        <params>
          <name>wisvc</name>
          <value>Disabled</value>
        </params>
      </action>
    </entry>
  </group>
  <group>
    <id>DS_Miscellaneous</id>
    <displayname>DS: Miscellaneous</displayname>
    <description>Disable miscellaneous items suchs as Data Execution Prevention (DEP), hibernate and Cortana.</description>
    <entry>
      <name>Disable Cortana</name>
      <description>Disable Cortana (HKLM\SOFTWARE\Policies\Microsoft\Windows\Windows Search -&gt; AllowCortana -&gt; 0 -&gt; DWORD).</description>
      <execute>1</execute>
      <action>
        <plugin>Registry</plugin>
        <params>
          <name>AllowCortana</name>
          <path>HKLM\SOFTWARE\Policies\Microsoft\Windows\Windows Search</path>
          <value>0</value>
          <valuetype>Dword</valuetype>
        </params>
      </action>
    </entry>
    <entry>
      <name>Disable Customer Experience Improvement Program (CEIP)</name>
      <description>Disable Customer Experience Improvement Program (HKLM\SOFTWARE\Microsoft\SQMClient\Windows -&gt; CEIPEnable -&gt; 0 -&gt; DWORD).</description>
      <execute>1</execute>
      <action>
        <plugin>Registry</plugin>
        <params>
          <name>CEIPEnable</name>
          <path>HKLM\SOFTWARE\Microsoft\SQMClient\Windows</path>
          <value>0</value>
          <valuetype>Dword</valuetype>
        </params>
      </action>
    </entry>
    <entry>
      <name>Disable Data Execution Prevention (DEP)</name>
      <description>Turn off Data Execution Prevention (DEP) recommended by Citrix (https://support.citrix.com/article/CTX216252) using the command "bcdedit.exe /set nx AlwaysOff". Does not support rollback.</description>
      <execute>1</execute>
      <action>
        <plugin>PowerShell</plugin>
        <analyzeparams>
          <value># Retrieve the current configuration of Data Execution Prevention (DEP). Possible results are: OptIn | OptOut | AlwaysOff | AlwaysOff
[string]$BCDValue = bcdedit.exe '/enum' '{default}'
[array]$BCDArray = $BCDValue.Split(" ",[System.StringSplitOptions]::RemoveEmptyEntries)
[string]$BCDResult = ($BCDArray[$BCDArray.IndexOf("nx")+1]).Trim()
if ( $BCDResult -eq "AlwaysOff" ) { $Global:CTXOE_Result = $True } else { $Global:CTXOE_Result = $False }
if ( $BCDResult -eq "AlwaysOff" ) { 
   $Global:CTXOE_Details = "Data Execution Prevention (DEP) is optimized (= disabled). Current value: $BCDResult. Rollback is currently not supported." 
} else {
   $Global:CTXOE_Details = "Data Execution Prevention (DEP) is NOT optimized (= enabled). Current value: $BCDResult. Rollback is currently not supported."
}
Return</value>
        </analyzeparams>
        <executeparams>
          <value>. $env:WinDir\System32\bcdedit.exe /set nx AlwaysOff;
$Global:CTXOE_Result = $True;
$Global:CTXOE_Details = "DEP was successfully disabled";
</value>
        </executeparams>
      </action>
    </entry>
    <entry>
      <name>Disable Hibernate</name>
      <description>Disable Hibernate (HKLM\SYSTEM\CurrentControlSet\Control\Power -&gt; HibernateEnabled -&gt; 0 -&gt; DWORD).</description>
      <execute>1</execute>
      <action>
        <plugin>Registry</plugin>
        <params>
          <name>HibernateEnabled</name>
          <path>HKLM\SYSTEM\CurrentControlSet\Control\Power</path>
          <value>0</value>
          <valuetype>Dword</valuetype>
        </params>
      </action>
    </entry>
    <entry>
      <name>Disable IPv6</name>
      <description>Disable IPv6 (HKLM\SYSTEM\CurrentControlSet\Services\Tcpip6\Parameters -&gt; DisabledComponents -&gt; 255 -&gt; DWORD).</description>
      <execute>1</execute>
      <action>
        <plugin>Registry</plugin>
        <params>
          <name>DisabledComponents</name>
          <path>HKLM\SYSTEM\CurrentControlSet\Services\Tcpip6\Parameters</path>
          <value>255</value>
          <valuetype>Dword</valuetype>
        </params>
      </action>
    </entry>
  </group>
  <group>
    <id>DS_NonPersistentOnly</id>
    <displayname>DS: NON-PERSISTENT only</displayname>
    <description>Various optimizations only required when creating a non-persistent image (changes are lost when the target device is rebooted).</description>
    <entry>
      <name>Disable clear page file at shutdown</name>
      <description>Disable clear page file at shutdown (HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\Memory Management -&gt; ClearPageFileAtShutdown -&gt; 0 -&gt; DWORD).</description>
      <execute>1</execute>
      <action>
        <plugin>Registry</plugin>
        <params>
          <name>ClearPageFileAtShutdown</name>
          <path>HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\Memory Management</path>
          <value>0</value>
          <valuetype>Dword</valuetype>
        </params>
      </action>
    </entry>
    <entry>
      <name>Disable Machine Account Password Changes</name>
      <description>Disable Machine Account Password Changes (HKLM\SYSTEM\CurrentControlSet\Services\Netlogon\Parameters -&gt; DisablePasswordChange -&gt; 1 -&gt; DWORD).</description>
      <execute>1</execute>
      <action>
        <plugin>Registry</plugin>
        <params>
          <name>DisablePasswordChange</name>
          <path>HKLM\SYSTEM\CurrentControlSet\Services\Netlogon\Parameters</path>
          <value>1</value>
          <valuetype>Dword</valuetype>
        </params>
      </action>
    </entry>
    <entry>
      <name>Disable Move to Recycle Bin</name>
      <description>Disable Move to Recycle Bin (HKLM\Software\Microsoft\Windows\CurrentVersion\Policies\Explorer -&gt; NoRecycleFiles -&gt; 1 -&gt; DWORD).</description>
      <execute>1</execute>
      <action>
        <plugin>Registry</plugin>
        <params>
          <name>NoRecycleFiles</name>
          <path>HKLM\Software\Microsoft\Windows\CurrentVersion\Policies\Explorer</path>
          <value>1</value>
          <valuetype>Dword</valuetype>
        </params>
      </action>
    </entry>
    <entry>
      <name>Disable System Recovery</name>
      <description>Disable System Recovery recommended by Citrix (https://support.citrix.com/article/CTX216252) using the command "bcdedit.exe /set recoveryenabled no". Does not support rollback.</description>
      <execute>1</execute>
      <action>
      <plugin>PowerShell</plugin>
	   <executeparams>
            <value>  . $env:WinDir\System32\bcdedit.exe /set recoveryenabled no;
		     $Global:CTXOE_Result = $True;
	             $Global:CTXOE_Details = "System Recovery was successfully disabled";
            </value>
           </executeparams>
            <params>
             <value>
              # Retrieve the current configuration of System Recovery.
              [string]$BCDValue = bcdedit.exe '/enum' '{default}'
              [array]$BCDArray = $BCDValue.Split(" ",[System.StringSplitOptions]::RemoveEmptyEntries)
              [string]$BCDResult = ($BCDArray[$BCDArray.IndexOf("recoveryenabled")+1]).Trim()
              if ( $BCDResult -eq "No" ) { $Global:CTXOE_Result = $True } else { $Global:CTXOE_Result = $False }
              if ( $BCDResult -eq "No" ) { $Global:CTXOE_Details = "System Recovery is optimized (= disabled). Current value: $BCDResult. Rollback is currently not supported." } else { $Global:CTXOE_Details = "System Recovery is NOT optimized (= enabled). Current value: $BCDResult. Rollback is currently not supported." }
              Return
             </value>
            </params>
        </action>
      </entry>
      <entry>
       <name>Native Image Generation (NGEN.exe) 32-bit</name>
        <description>THIS IS SLOW, it's normal for this operation to take a long time (about 2 minutes on a clean Windows Server 2016 version 1607). This optimization pre-compiles .NET assemblies instead of using the just-in-time compilation using NGEN.exe. Does not support analyze/rollback modes, but it is generally safe to use. Note: the status of this setting is always displayed as "optimized" within Citrix Opimizer. Please ignore this status and always execute this item when sealing your image.</description>
        <execute>1</execute>
        <action>
          <plugin>PowerShell</plugin>
          <executeparams>
            <value>
               . $Env:WinDir\Microsoft.Net\Framework\v4.0.30319\ngen.exe Update;
               $Global:CTXOE_Result = $True;
               $Global:CTXOE_Details = ".NET assemblies have been optimized";
            </value>
          </executeparams>
          <params>
            <value>
               Write-Host "This optimization does not support analyze or rollback modes, skipping...";
               $Global:CTXOE_Result = $True;
               $Global:CTXOE_Details = "Analyze/Rollback not supported/required, skipping...";
               Return;
            </value>
          </params>
        </action>
      </entry>
      <entry>
        <name>Native Image Generation (NGEN.exe) 64-bit</name>
        <description>THIS IS SLOW, it's normal for this operation to take a long time (about 2 minutes on a clean Windows Server 2016 version 1607). This optimization pre-compiles .NET assemblies instead of using the just-in-time compilation using NGEN.exe. Does not support analyze/rollback modes, but it is generally safe to use. Note: the status of this setting is always displayed as "optimized" within Citrix Opimizer. Please ignore this status and always execute this item when sealing your image.</description>
        <execute>1</execute>
        <action>
          <plugin>PowerShell</plugin>
          <executeparams>
           <value>
              If ($(Test-Path $Env:WinDir\Microsoft.Net\Framework64\v4.0.30319\ngen.exe) -eq $True) {
                 . $Env:WinDir\Microsoft.Net\Framework64\v4.0.30319\ngen.exe Update;
                 $Global:CTXOE_Details = ".NET assemblies have been optimized";
              } Else {
                 $Global:CTXOE_Details = "Skipping, no 64-bit NGEN.exe found";
              }
              $Global:CTXOE_Result = $True;
           </value>
          </executeparams>
          <params>
           <value>
              Write-Host "This optimization does not support analyze or rollback modes, skipping...";
              $Global:CTXOE_Result = $True;
              $Global:CTXOE_Details = "Analyze/Rollback not supported/required, skipping...";
              Return;
           </value>
          </params>
        </action>
      </entry>
  </group>
</root>